<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fengxiu.club","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":true,"nav":{"disqus":{"text":"评论","order":-1}},"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Hibernate Validator 学习与使用 在项目，校验数据是必不可少的一步。因此如果能写出一个好的校验代码，必定能提高项目的鲁棒性。目前我做的项目大部分使用的是SpringBoot，基本上都是在控制器那一层通过注解@Valid等来校验参数，虽然经常使用，但是没有好好的进行整理。所以接下来会写几篇文章，对这一块进行整理。 大概会整理如下几个部分  Hibernate Validator的用">
<meta property="og:type" content="article">
<meta property="og:title" content="Hibernate Validator 学习与使用">
<meta property="og:url" content="http://fengxiu.club/archives/fc06a9d1.html">
<meta property="og:site_name" content="枫秀学习日志">
<meta property="og:description" content="Hibernate Validator 学习与使用 在项目，校验数据是必不可少的一步。因此如果能写出一个好的校验代码，必定能提高项目的鲁棒性。目前我做的项目大部分使用的是SpringBoot，基本上都是在控制器那一层通过注解@Valid等来校验参数，虽然经常使用，但是没有好好的进行整理。所以接下来会写几篇文章，对这一块进行整理。 大概会整理如下几个部分  Hibernate Validator的用">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/fengxiu/img/application-layers.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/fengxiu/img/application-layers2.png">
<meta property="article:published_time" content="2020-09-28T10:09:53.000Z">
<meta property="article:modified_time" content="2025-04-27T03:10:24.798Z">
<meta property="article:author" content="枫秀">
<meta property="article:tag" content="java">
<meta property="article:tag" content="spring">
<meta property="article:tag" content="分布式">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/fengxiu/img/application-layers.png">

<link rel="canonical" href="http://fengxiu.club/archives/fc06a9d1.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Hibernate Validator 学习与使用 | 枫秀学习日志</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="枫秀学习日志" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">枫秀学习日志</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">枫秀学习日志</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">99</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">49</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">228</span></a>

  </li>
        <li class="menu-item menu-item-goodarticle">

    <a href="/good/" rel="section"><i class="fa fa-fw fa-bookmark"></i>技术文章摘抄</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://fengxiu.club/archives/fc06a9d1.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cdn.jsdelivr.net/gh/fengxiu/img/avatar.jpg">
      <meta itemprop="name" content="枫秀">
      <meta itemprop="description" content="记录学习日志">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="枫秀学习日志">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hibernate Validator 学习与使用
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-28 10:09:53" itemprop="dateCreated datePublished" datetime="2020-09-28T10:09:53+00:00">2020-09-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-04-27 03:10:24" itemprop="dateModified" datetime="2025-04-27T03:10:24+00:00">2025-04-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/%E6%95%99%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">教程</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/archives/fc06a9d1.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="archives/fc06a9d1.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/archives/fc06a9d1.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/archives/fc06a9d1.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>23k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>21 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Hibernate-Validator-学习与使用"><a href="#Hibernate-Validator-学习与使用" class="headerlink" title="Hibernate Validator 学习与使用"></a>Hibernate Validator 学习与使用</h1><!-- 
    1.  配置
    2.  简单的demo
    3.  如何声明和校验约束 : 约束集成，级联约束
    4.  自定义约束
    5.  配置约束错误语句
    6.  配置ValueExectuao
    7.  配置Validator
    8.  
 -->
<p>在项目，校验数据是必不可少的一步。因此如果能写出一个好的校验代码，必定能提高项目的鲁棒性。目前我做的项目大部分使用的是SpringBoot，基本上都是在控制器那一层通过注解@Valid等来校验参数，虽然经常使用，但是没有好好的进行整理。所以接下来会写几篇文章，对这一块进行整理。</p>
<p>大概会整理如下几个部分</p>
<ol>
<li>Hibernate Validator的用法，</li>
<li>如何在Spring中使用Hibernate Validator</li>
<li>介绍如何在Spring MVC中使用。</li>
<li>分析Spring MVC使用Validator的原理。</li>
</ol>
<p>本篇文章主要是对Hibernate Validator用法进行简单的介绍</p>
<h2 id="Hibernate-Validator简介"><a href="#Hibernate-Validator简介" class="headerlink" title="Hibernate Validator简介"></a>Hibernate Validator简介</h2><p>验证数据是贯穿所有应用程序层（从应用层到持久层）的常见任务。通常在每一层都实现相同的验证逻辑，这是非常耗时和容易出错的。为了避免这些验证的重复，开发人员经常将验证逻辑直接绑定到域模型中，用验证代码（实际上是关于类本身的元数据）将域类弄乱。<br><img src="https://cdn.jsdelivr.net/gh/fengxiu/img/application-layers.png" alt="application-layers"></p>
<p>Jakarta Bean Validation 2.0——为Entity和方法的验证定义了一个元数据模型和API。默认的元数据源是Annotation，同时也能够通过使用XML覆盖和扩展元数据。API没有绑定到特定的应用层或者programming model.。它与web层或持久层都没有强绑定，可用于服务器端应用程序编程和客户端上应用程序。<br><img src="https://cdn.jsdelivr.net/gh/fengxiu/img/application-layers2.png" alt="application-layers2"></p>
<p>Hibernate Validator和Jakarta Bean Validation的区别：Jakarta Bean Validation是一种规范，Hibernate Validator是对个规范的一种实现。</p>
<span id="more"></span>
<h2 id="简单使用例子"><a href="#简单使用例子" class="headerlink" title="简单使用例子"></a>简单使用例子</h2><p>maven 配置如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate.validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>6.1.5.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.el<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>应用约束在Java Bean上</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.hibernate.validator.referenceguide.chapter01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Min;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.Size;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size(min = 2, max = 14)</span></span><br><span class="line">    <span class="keyword">private</span> String licensePlate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(2)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seatCount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(String manufacturer, String licencePlate, <span class="type">int</span> seatCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">        <span class="built_in">this</span>.licensePlate = licencePlate;</span><br><span class="line">        <span class="built_in">this</span>.seatCount = seatCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//getters and setters ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li>@NotNull：表明这个属性不能为null</li>
<li>@Size： 表明licensePlate的长度在2到14个字符之间</li>
<li>@Min ：表明seatCount最小是2</li>
</ol>
<p>上面的例子已经完整的定义了对这个Bean的约束，下面的代码是如何验证这些约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> javax.validation.ConstraintViolation;</span><br><span class="line"><span class="keyword">import</span> javax.validation.Validation;</span><br><span class="line"><span class="keyword">import</span> javax.validation.Validator;</span><br><span class="line"><span class="keyword">import</span> javax.validation.ValidatorFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.BeforeClass;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.assertEquals;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CarTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Validator validator;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setUpValidator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ValidatorFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Validation.buildDefaultValidatorFactory();</span><br><span class="line">        validator = factory.getValidator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">manufacturerIsNull</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="literal">null</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">4</span> );</span><br><span class="line"></span><br><span class="line">        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =</span><br><span class="line">                validator.validate( car );</span><br><span class="line"></span><br><span class="line">        assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">        assertEquals( <span class="string">&quot;must not be null&quot;</span>, constraintViolations.iterator().next().getMessage() );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">licensePlateTooShort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="number">4</span> );</span><br><span class="line"></span><br><span class="line">        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =</span><br><span class="line">                validator.validate( car );</span><br><span class="line"></span><br><span class="line">        assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">        assertEquals(</span><br><span class="line">                <span class="string">&quot;size must be between 2 and 14&quot;</span>,</span><br><span class="line">                constraintViolations.iterator().next().getMessage()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seatCountTooLow</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">1</span> );</span><br><span class="line"></span><br><span class="line">        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =</span><br><span class="line">                validator.validate( car );</span><br><span class="line"></span><br><span class="line">        assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">        assertEquals(</span><br><span class="line">                <span class="string">&quot;must be greater than or equal to 2&quot;</span>,</span><br><span class="line">                constraintViolations.iterator().next().getMessage()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">carIsValid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">2</span> );</span><br><span class="line"></span><br><span class="line">        Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations =</span><br><span class="line">                validator.validate( car );</span><br><span class="line"></span><br><span class="line">        assertEquals( <span class="number">0</span>, constraintViolations.size() );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在setUp()方法中，使用ValidatorFactory创建一个Validator对象。Validator实例是线程安全的，可以多次重用。因此，它可以安全地存储在static属性中，并用于测试方法，以验证不同的Car实例。</p>
<p>调用validate()方法返回一组ConstraintViolation实例，您可以对其进行迭代，以查看发生了哪些验证错误。</p>
<p>前三个测试方法显示了一些预期的约束冲突：</p>
<ul>
<li>在manufacturerIsNull()中违反了对manufacturer的@NotNull约束</li>
<li>licensePlateTooShort()中违反了对licensePlateTooShort上的@Size约束</li>
<li>seatCountTooLow()中违反了seatCount上的@Min约束</li>
</ul>
<p>如果对象验证成功，validate()将返回一个空集，如carIsValid()方法中所示。</p>
<h2 id="如何声明和校验约束"><a href="#如何声明和校验约束" class="headerlink" title="如何声明和校验约束"></a>如何声明和校验约束</h2><p>约束声明即约束可以放置的位置，主要有以下俩大类，一种是放置在Bean上，另外一种是放置在方法上。校验约束根据校验的对象，也分为俩种，一种是对Bean约束校验，一种是对方法约束校验。</p>
<h3 id="声明bean约束"><a href="#声明bean约束" class="headerlink" title="声明bean约束"></a>声明bean约束</h3><p>Jakarta Bean Validation中的约束通过Java注解表示。在Bean上声明约束，主要有以下四种类型的bean约束：</p>
<ul>
<li>field constraints</li>
<li>property constraints</li>
<li>container element constraints</li>
<li>class constraints</li>
</ul>
<h4 id="属性约束-field-constraints"><a href="#属性约束-field-constraints" class="headerlink" title="属性约束(field constraints)"></a>属性约束(field constraints)</h4><p>约束可以通过注解类的字段来表示。下面是一个实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> isRegistered;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(String manufacturer, <span class="type">boolean</span> isRegistered)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">        <span class="built_in">this</span>.isRegistered = isRegistered;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//getters and setters...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当使用field-leve级别的约束时，约束可以应用于任何访问类型（public、private等）的字段。不过，不支持对静态字段的约束。</p>
<!-- 这里我的猜想它是通过反射来获取属性值进行验证。 -->

<p>注意：验证字节码增强的对象时，应该使用property level约束，因为字节码增强库无法通过反射确定字段访问。</p>
<h4 id="Property-level-constraints"><a href="#Property-level-constraints" class="headerlink" title="Property-level constraints"></a>Property-level constraints</h4><p>如果定义的model遵从JavaBean规范，也可以注解这些properties代替注解field。这里需要说明的一点是，Field大概是指类的内部成员变量，property是指在可以被外部通过getter&#x2F;setter方法读取或者设置的属性<br>区别可以看这篇文章<a target="_blank" rel="noopener" href="https://xinxingastro.github.io/2018/07/21/Java/Java%E4%B8%ADfield%E5%92%8Cproperty%E7%9A%84%E5%8C%BA%E5%88%AB/">Java中field和property的区别</a></p>
<p>实例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> isRegistered;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(String manufacturer, <span class="type">boolean</span> isRegistered)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">        <span class="built_in">this</span>.isRegistered = isRegistered;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getManufacturer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> manufacturer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setManufacturer</span><span class="params">(String manufacturer)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isRegistered</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isRegistered;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRegistered</span><span class="params">(<span class="type">boolean</span> isRegistered)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.isRegistered = isRegistered;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里需要注意的一点是，是Property的getter方法被注解，不是setter方法。另外在使用约束的时候，在一个class里面最好field和Property俩个只选择一个，否则会出现校验俩次的现象。</p>
<h4 id="Container-element-约束"><a href="#Container-element-约束" class="headerlink" title="Container element 约束"></a>Container element 约束</h4><p>可以直接在参数化类型的类型参数上指定约束：这些约束称为Container element约束。</p>
<p>Hibernate Validator 支持的container element约束有以下几种</p>
<ul>
<li>实现了Java.tuil.Iterable(List ,Set)</li>
<li>实现了java.util.Map，支持验证key和value</li>
<li>Java.util.Optional 一类的</li>
<li>实现了javafx.beans.observable.ObservableValue</li>
</ul>
<p>另外也可以自定义container element 约束在自定义的container类型上。</p>
<p>下面是一个Set的例子，其它的Container element约束和这个差不多</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;<span class="meta">@NotNull</span> String&gt; parts = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addPart</span><span class="params">(String part)</span> &#123;</span><br><span class="line">        parts.add(part);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Class-level-约束"><a href="#Class-level-约束" class="headerlink" title="Class-level 约束"></a>Class-level 约束</h4><p>约束也可以放在class-level上，在这种情况下，不是单一的属性被验证，而是验证完整的对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ValidPassengerCount</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seatCount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Person&gt; passengers;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ValidPassengerCount这个是自定义约束，用于验证passengers的长度是否小于seatCount。</p>
<h3 id="校验bean约束"><a href="#校验bean约束" class="headerlink" title="校验bean约束"></a>校验bean约束</h3><p>主要是通过Validator进行校验，Validator是一个接口、下一节将展示如何获取Validator实例。<br>之后，您将学习如何使用Validator接口的不同方法。</p>
<h4 id="获取Validator实例"><a href="#获取Validator实例" class="headerlink" title="获取Validator实例"></a>获取Validator实例</h4><p>通常是通过Validation和ValidatorFactory类来获取，示例如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValidatorFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Validation.buildDefaultValidatorFactory();</span><br><span class="line">validator = factory.getValidator();</span><br></pre></td></tr></table></figure>

<h4 id="Validator-方法介绍"><a href="#Validator-方法介绍" class="headerlink" title="Validator 方法介绍"></a>Validator 方法介绍</h4><p>Validator接口主要有三个方法，被用于验证整个实体或者实体的属性。</p>
<p>这三个方法都会返回Set&lt; ConstraintViolation&gt;类型的对象，如果为空，则表示没有错误。</p>
<p>所有的验证方法都有一个可变参数，用于指定验证的Group，如果参数没有指定，则表示使用默认的组。同时也可以指定多个group。</p>
<h5 id="validate"><a href="#validate" class="headerlink" title="validate()"></a>validate()</h5><p>这个方法用于验证一个Bean的所有约束。<br>示例如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="literal">null</span>, <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals( <span class="string">&quot;must not be null&quot;</span>, constraintViolations.iterator().next().getMessage() );</span><br></pre></td></tr></table></figure>

<h5 id="validateProperty"><a href="#validateProperty" class="headerlink" title="validateProperty()"></a>validateProperty()</h5><p>可以用于验证一个给定对象的单个Property。</p>
<p>实例如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="literal">null</span>, <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validateProperty(</span><br><span class="line">        car,</span><br><span class="line">        <span class="string">&quot;manufacturer&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals( <span class="string">&quot;must not be null&quot;</span>, constraintViolations.iterator().next().getMessage() );</span><br></pre></td></tr></table></figure>

<h5 id="validateValue"><a href="#validateValue" class="headerlink" title="validateValue()"></a>validateValue()</h5><p>可以验证一个对象的单独Property或者完整对象，如果没有指定Property，则验证完整对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validateValue(</span><br><span class="line">        Car.class,</span><br><span class="line">        <span class="string">&quot;manufacturer&quot;</span>,</span><br><span class="line">        <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals( <span class="string">&quot;must not be null&quot;</span>, constraintViolations.iterator().next().getMessage() );</span><br></pre></td></tr></table></figure>

<h3 id="声明方法约束"><a href="#声明方法约束" class="headerlink" title="声明方法约束"></a>声明方法约束</h3><p>方法约束主要分为俩大类，一个是对参数的约束，另外一个是对方法返回值的约束。</p>
<h4 id="参数约束"><a href="#参数约束" class="headerlink" title="参数约束"></a>参数约束</h4><p>声明参数约束和声明Bean约束大体上是差不多的，例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentalStation</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RentalStation</span><span class="params">(<span class="meta">@NotNull</span> String name)</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rentCar</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@NotNull</span> Customer customer,</span></span><br><span class="line"><span class="params">            <span class="meta">@NotNull</span> <span class="meta">@Future</span> Date startDate,</span></span><br><span class="line"><span class="params">            <span class="meta">@Min(1)</span> <span class="type">int</span> durationInDays)</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的声明表达的意思和在Bean约束中表达的意思是一样的，只是用的地点不一样而已。这里需要注意的一点是，方法本身执行的时候，并不会去验证这些约束，需要在方法执行前，调用ExecutableValidator来验证这些约束，这些约束才会生效。一般会通过代理，Aop等方式来在方法调用前进行拦截，验证这些约束。通常情况下，约束仅用于实例方法。</p>
<h4 id="Cross-parameter（交叉验证）"><a href="#Cross-parameter（交叉验证）" class="headerlink" title="Cross-parameter（交叉验证）"></a>Cross-parameter（交叉验证）</h4><p>有时一个方法的约束，可能需要保证参数一起满足特定的条件，这时就需要Cross-parameter。声明例子如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@LuggageCountMatchesPassengerCount(piecesOfLuggagePerPassenger = 2)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">load</span><span class="params">(List&lt;Person&gt; passengers, List&lt;PieceOfLuggage&gt; luggage)</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>LuggageCountMatchesPassengerCount 这个是一种自定义约束，用来限制，passengers和luggage的数量一致。</p>
<h4 id="返回值约束"><a href="#返回值约束" class="headerlink" title="返回值约束"></a>返回值约束</h4><p>方法返回值约束，声明如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentalStation</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ValidRentalStation</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RentalStation</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size(min = 1)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;<span class="meta">@NotNull</span> Customer&gt; getCustomers() &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中方法参数约束和返回值约束使用位置一样，主要通过以下方式来区分，在注解中指定validationAppliesTo的值，例子如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Garage &#123;</span><br><span class="line"></span><br><span class="line">    @ELAssert(expression = &quot;...&quot;, validationAppliesTo = ConstraintTarget.PARAMETERS)</span><br><span class="line">    public Car buildCar(List&lt;Part&gt; parts) &#123;</span><br><span class="line">        //...</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @ELAssert(expression = &quot;...&quot;, validationAppliesTo = ConstraintTarget.RETURN_VALUE)</span><br><span class="line">    public Car paintCar(int color) &#123;</span><br><span class="line">        //...</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以下三种情况，不用指定，验证方法自动可以判断</p>
<ol>
<li>没有返回值的方法，默认为参数类型验证。</li>
<li>没有参数的方法，默认为返回值类型约束</li>
<li>Bean约束不用指定。</li>
</ol>
<h3 id="验证方法约束"><a href="#验证方法约束" class="headerlink" title="验证方法约束"></a>验证方法约束</h3><p>主要是通过ExecutableValidator接口来进行验证</p>
<h4 id="获取实例"><a href="#获取实例" class="headerlink" title="获取实例"></a>获取实例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValidatorFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Validation.buildDefaultValidatorFactory();</span><br><span class="line">executableValidator = factory.getValidator().forExecutables();</span><br></pre></td></tr></table></figure>

<h4 id="方法使用"><a href="#方法使用" class="headerlink" title="方法使用"></a>方法使用</h4><p>主要有以下四个方法</p>
<ol>
<li>validateParameters ：验证方法参数</li>
<li>validateConstructorParameters：验证构造器方法</li>
<li>validateReturnValue：验证方法返回值</li>
<li>validateConstructorReturnValue：验证构造器返回值</li>
</ol>
<p>使用方式都差不多，这里介绍下方法相关的验证</p>
<p>参数验证</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Car</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span> );</span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> Car.class.getMethod( <span class="string">&quot;drive&quot;</span>, <span class="type">int</span>.class );</span><br><span class="line">Object[] parameterValues = &#123; <span class="number">80</span> &#125;;</span><br><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateParameters(</span><br><span class="line">        object,</span><br><span class="line">        method,</span><br><span class="line">        parameterValues</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">1</span>, violations.size() );</span><br><span class="line">Class&lt;? <span class="keyword">extends</span> <span class="title class_">Annotation</span>&gt; constraintType = violations.iterator()</span><br><span class="line">        .next()</span><br><span class="line">        .getConstraintDescriptor()</span><br><span class="line">        .getAnnotation()</span><br><span class="line">        .annotationType();</span><br><span class="line">assertEquals( Max.class, constraintType );</span><br></pre></td></tr></table></figure>

<p>返回值验证</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Car</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span> );</span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> Car.class.getMethod( <span class="string">&quot;getPassengers&quot;</span> );</span><br><span class="line"><span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> Collections.&lt;Passenger&gt;emptyList();</span><br><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; violations = executableValidator.validateReturnValue(</span><br><span class="line">        object,</span><br><span class="line">        method,</span><br><span class="line">        returnValue</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">1</span>, violations.size() );</span><br><span class="line">Class&lt;? <span class="keyword">extends</span> <span class="title class_">Annotation</span>&gt; constraintType = violations.iterator()</span><br><span class="line">        .next()</span><br><span class="line">        .getConstraintDescriptor()</span><br><span class="line">        .getAnnotation()</span><br><span class="line">        .annotationType();</span><br><span class="line">assertEquals( Size.class, constraintType );</span><br></pre></td></tr></table></figure>
<h3 id="内置的Bean约束"><a href="#内置的Bean约束" class="headerlink" title="内置的Bean约束"></a>内置的Bean约束</h3><p>这一块具体可以看<a target="_blank" rel="noopener" href="https://docs.jboss.org/hibernate/validator/4.3/reference/zh-CN/html_single/#validator-defineconstraints-builtin">内置约束</a><br>不过这个是比较老的版本，如果你的英文还可以，可以去看官方文档。</p>
<h2 id="约束继承"><a href="#约束继承" class="headerlink" title="约束继承"></a>约束继承</h2><p>对于声明在Bean上的约束，当一个类实现一个接口或者类时，所有父类上的约束都会应用在子类上。</p>
<p>例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getManufacturer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> manufacturer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentalCar</span> <span class="keyword">extends</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rentalStation;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getRentalStation</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> rentalStation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比如上面的RentCar继承了Car，当进行约束验证的时候，同时会验证manufacturer是否符合要求。</p>
<p>对于方法上的约束集成，则不允许覆盖参数类型的约束，也就是父类型的方法参数上指定了约束，子类的方法参数只能继承此约束，而不能覆盖或者重写。对于返回值，则是采用累加的策略。</p>
<p>下面这个类实现的例子，就是违反了方法约束规则，运行时会报错</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">drive</span><span class="params">(<span class="meta">@Max(75)</span> <span class="type">int</span> speedInMph)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> <span class="keyword">implements</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">drive</span><span class="params">(<span class="meta">@Max(55)</span> <span class="type">int</span> speedInMph)</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回值约束继承的例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    List&lt;Person&gt; <span class="title function_">getPassengers</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> <span class="keyword">implements</span> <span class="title class_">Vehicle</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Size(min = 1)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Person&gt; <span class="title function_">getPassengers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个例子中，对于getPassengers这个方法，会同时校验@NotNull和@Size俩个约束</p>
<h2 id="级联验证"><a href="#级联验证" class="headerlink" title="级联验证"></a>级联验证</h2><p>Jakarta Bean Validation API不仅允许验证单个类实例，同时还会验证Object graphs，看下面的例子，你就可以理解这是什么意思</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Valid</span></span><br><span class="line">    <span class="keyword">private</span> Person driver;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当校验上面的Car对象时，属性引用的Person对象也会被校验。这是因为在Car的Person属性上加了@Valid注解，当验证Person对象里面约束失败时，对Car对象的验证也会失败。</p>
<p>这里需要注意的一点是，在级联验证时，null默认会被忽略掉。</p>
<p>级联验证也可以被用在Container element 约束上。具体例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;<span class="meta">@NotNull</span> <span class="meta">@Valid</span> Person&gt; passengers = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Person&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;<span class="meta">@Valid</span> Part, List&lt;<span class="meta">@Valid</span> Manufacturer&gt;&gt; partManufacturers = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Part</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Manufacturer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在方法参数上也可以使用级联验证，使用方式和上面列举的一样，只是在参数前面加上@Valid注解。<br>具体例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Garage</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">checkCars</span><span class="params">(<span class="meta">@NotNull</span> List&lt;<span class="meta">@Valid</span> Car&gt; cars)</span> &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="分组校验"><a href="#分组校验" class="headerlink" title="分组校验"></a>分组校验</h2><p>分组校验允许我们在同一个类里面，在不同的场景下有不同的校验规则。具体的用法看下面这个例子：</p>
<p>Person实体</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters and setters ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面的约束@NotNull并没有指定group参数，这表明此约束用在javax.validation.groups.Default这个组下面。</p>
<p>Driver实体，继承了Person，并限制了年龄最小是18，同时必须拥有驾照。定义如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Driver</span> <span class="keyword">extends</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(</span></span><br><span class="line"><span class="meta">            value = 18,</span></span><br><span class="line"><span class="meta">            message = &quot;You have to be 18 to drive a car&quot;,</span></span><br><span class="line"><span class="meta">            groups = DriverChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue(</span></span><br><span class="line"><span class="meta">            message = &quot;You first have to pass the driving test&quot;,</span></span><br><span class="line"><span class="meta">            groups = DriverChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> hasDrivingLicense;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Driver</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>( name );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">passedDrivingTest</span><span class="params">(<span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">        hasDrivingLicense = b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的DriverCheck类只是起到一个标记的作用，区分这个约束用在DriverChek这个组。DriverClass定义如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DriverChecks</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后定义Car实体，这个指定了部分约束用在Default这个组，一部分约束用在CarCheck这个组，具体定义如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size(min = 2, max = 14)</span></span><br><span class="line">    <span class="keyword">private</span> String licensePlate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(2)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seatCount;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue(</span></span><br><span class="line"><span class="meta">            message = &quot;The car has to pass the vehicle inspection first&quot;,</span></span><br><span class="line"><span class="meta">            groups = CarChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> passedVehicleInspection;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Valid</span></span><br><span class="line">    <span class="keyword">private</span> Driver driver;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(String manufacturer, String licencePlate, <span class="type">int</span> seatCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">        <span class="built_in">this</span>.licensePlate = licencePlate;</span><br><span class="line">        <span class="built_in">this</span>.seatCount = seatCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPassedVehicleInspection</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> passedVehicleInspection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassedVehicleInspection</span><span class="params">(<span class="type">boolean</span> passedVehicleInspection)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.passedVehicleInspection = passedVehicleInspection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Driver <span class="title function_">getDriver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> driver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDriver</span><span class="params">(Driver driver)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.driver = driver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters and setters ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CarChecks</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里对上面三个类不同约束的分组进行整理：</p>
<ul>
<li>Default : Person.name , Car.manufacturer,Car.licensePlate ，Car.seatCount</li>
<li>DriverCheck: Driver.age,Driver.hasDrivingLicense</li>
<li>CarCehck:  Car.passedVehicleInspection</li>
</ul>
<p>下面演示如何使用分组校验：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 校验默认分组，也就是Group</span></span><br><span class="line"><span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">2</span> );</span><br><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );</span><br><span class="line">assertEquals( <span class="number">0</span>, constraintViolations.size() );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 校验CarCheck分组</span></span><br><span class="line">constraintViolations = validator.validate( car, CarChecks.class );</span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals(</span><br><span class="line">        <span class="string">&quot;The car has to pass the vehicle inspection first&quot;</span>,</span><br><span class="line">        constraintViolations.iterator().next().getMessage()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置让校验通过CarCheck分组</span></span><br><span class="line">car.setPassedVehicleInspection( <span class="literal">true</span> );</span><br><span class="line">assertEquals( <span class="number">0</span>, validator.validate( car, CarChecks.class ).size() );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 校验DriverCheck分组</span></span><br><span class="line"><span class="type">Driver</span> <span class="variable">john</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Driver</span>( <span class="string">&quot;John Doe&quot;</span> );</span><br><span class="line">john.setAge( <span class="number">18</span> );</span><br><span class="line">car.setDriver( john );</span><br><span class="line">constraintViolations = validator.validate( car, DriverChecks.class );</span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals(</span><br><span class="line">        <span class="string">&quot;You first have to pass the driving test&quot;</span>,</span><br><span class="line">        constraintViolations.iterator().next().getMessage()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置让校验通过DriverCheck分组</span></span><br><span class="line">john.passedDrivingTest( <span class="literal">true</span> );</span><br><span class="line">assertEquals( <span class="number">0</span>, validator.validate( car, DriverChecks.class ).size() );</span><br><span class="line"></span><br><span class="line"><span class="comment">//校验所有的分组</span></span><br><span class="line">assertEquals(</span><br><span class="line">        <span class="number">0</span>, validator.validate(</span><br><span class="line">        car,</span><br><span class="line">        Default.class,</span><br><span class="line">        CarChecks.class,</span><br><span class="line">        DriverChecks.class</span><br><span class="line">).size()</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在校验时没有指定group参数，则表示使用Default组内的约束来校验。</p>
<h3 id="Group-inheritance"><a href="#Group-inheritance" class="headerlink" title="Group inheritance"></a>Group inheritance</h3><p>在上面的例子中，如果我们想要校验多个分组，必须把所有组类型传递到Validate()参数中。有时，一些组是包含另外一组的所约束，如果再按照上面那样一个个的指定，比较麻烦。这时就可以使用Group inheritance来简化。</p>
<p>下面的例子，我们定义了一个SuperCar类型，并定义RaceCarCheck组，RaceCarCheck继承了Default组，定义如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuperCar</span> <span class="keyword">extends</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue(</span></span><br><span class="line"><span class="meta">            message = &quot;Race car must have a safety belt&quot;,</span></span><br><span class="line"><span class="meta">            groups = RaceCarChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> safetyBelt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size(min = 2, max = 14)</span></span><br><span class="line">    <span class="keyword">private</span> String licensePlate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(2)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seatCount;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(String manufacturer, String licencePlate, <span class="type">int</span> seatCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">        <span class="built_in">this</span>.licensePlate = licencePlate;</span><br><span class="line">        <span class="built_in">this</span>.seatCount = seatCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters and setters ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RaceCarChecks</span> <span class="keyword">extends</span> <span class="title class_">Default</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>校验方法定义如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建SuperCar，并校验默认分组，即Default</span></span><br><span class="line"><span class="type">SuperCar</span> <span class="variable">superCar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SuperCar</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">1</span>  );</span><br><span class="line">assertEquals( <span class="string">&quot;must be greater than or equal to 2&quot;</span>, validator.validate( superCar ).iterator().next().getMessage() );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 校验SuperCar，是否满足RaceCarChecks分组定义的约束，这里同时会校验默认约束</span></span><br><span class="line">Set&lt;ConstraintViolation&lt;SuperCar&gt;&gt; constraintViolations = validator.validate( superCar, RaceCarChecks.class );</span><br><span class="line"></span><br><span class="line">assertThat( constraintViolations ).extracting( <span class="string">&quot;message&quot;</span> ).containsOnly(</span><br><span class="line">        <span class="string">&quot;Race car must have a safety belt&quot;</span>,</span><br><span class="line">        <span class="string">&quot;must be greater than or equal to 2&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>上面定义了俩个校验，第一个校验的是默认分组，第二校验RaceCarCheck分组，这里也会同时校验Default分组。</p>
<h3 id="定义分组验证的顺序"><a href="#定义分组验证的顺序" class="headerlink" title="定义分组验证的顺序"></a>定义分组验证的顺序</h3><p>有时，校验约束需要一个特定顺序，这个功能点是通过@GroupSequence这个注解来实现。</p>
<p>例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GroupSequence(&#123; Default.class, CarChecks.class, DriverChecks.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderedChecks</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>校验的例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">2</span> );</span><br><span class="line">car.setPassedVehicleInspection( <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line"><span class="type">Driver</span> <span class="variable">john</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Driver</span>( <span class="string">&quot;John Doe&quot;</span> );</span><br><span class="line">john.setAge( <span class="number">18</span> );</span><br><span class="line">john.passedDrivingTest( <span class="literal">true</span> );</span><br><span class="line">car.setDriver( john );</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">0</span>, validator.validate( car, OrderedChecks.class ).size() );</span><br></pre></td></tr></table></figure>

<p>校验就是讲这里定义分组校验顺序的注解传入到校验方法中即可。当执行校验的时候，会按照这个顺序来校验。这样做有一个好处是，Hibernate Validator遇到第一个违法约束市，就会直接抛出错误，加快校验。</p>
<h3 id="重定义Default-分组"><a href="#重定义Default-分组" class="headerlink" title="重定义Default 分组"></a>重定义Default 分组</h3><p>@GroupSequence出了定义校验分组的顺序，也可以重写Default分组包含的约束。使用方式是在校验的类上加上这个注解，并在其中包含Default需要包含哪些分组。<br>例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GroupSequence(&#123; RentalChecks.class, CarChecks.class, RentalCar.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentalCar</span> <span class="keyword">extends</span> <span class="title class_">Car</span> &#123;</span><br><span class="line">    <span class="meta">@AssertFalse(message = &quot;The car is currently rented out&quot;, groups = RentalChecks.class)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> rented;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RentalCar</span><span class="params">(String manufacturer, String licencePlate, <span class="type">int</span> seatCount)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>( manufacturer, licencePlate, seatCount );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isRented</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> rented;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRented</span><span class="params">(<span class="type">boolean</span> rented)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rented = rented;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">RentalChecks</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的例子定义，校验RentalChecks, CarChecks 和RentalCar这三个分组，通过校验Default就可以达到。</p>
<p>校验的例子如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">RentalCar</span> <span class="variable">rentalCar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RentalCar</span>( <span class="string">&quot;Morris&quot;</span>, <span class="string">&quot;DD-AB-123&quot;</span>, <span class="number">2</span> );</span><br><span class="line">rentalCar.setPassedVehicleInspection( <span class="literal">true</span> );</span><br><span class="line">rentalCar.setRented( <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line">Set&lt;ConstraintViolation&lt;RentalCar&gt;&gt; constraintViolations = validator.validate( rentalCar );</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals(</span><br><span class="line">        <span class="string">&quot;Wrong message&quot;</span>,</span><br><span class="line">        <span class="string">&quot;The car is currently rented out&quot;</span>,</span><br><span class="line">        constraintViolations.iterator().next().getMessage()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">rentalCar.setRented( <span class="literal">false</span> );</span><br><span class="line">constraintViolations = validator.validate( rentalCar );</span><br><span class="line"></span><br><span class="line">assertEquals( <span class="number">0</span>, constraintViolations.size() );</span><br></pre></td></tr></table></figure>

<p>这里有一点需要注意的是，覆盖Default分组包含的范围，只会在当前类中生效，不会传播到其它类上。</p>
<p>冲定义默认分组，出了使用上面的方式，还可以通过SPI的方式来实现。Hibernate Validator定义了一个DefaultGroupSequenceProvider接口，用于重写默认分组包含的内容，并通过@GroupSequenceProvider注解引入到相应的类上。<br>例子如下,定义一个新的DefaultGroupSequenceProvider</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentalCarGroupSequenceProvider</span></span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">DefaultGroupSequenceProvider</span>&lt;RentalCar&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Class&lt;?&gt;&gt; getValidationGroups(RentalCar car) &#123;</span><br><span class="line">        List&lt;Class&lt;?&gt;&gt; defaultGroupSequence = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Class&lt;?&gt;&gt;();</span><br><span class="line">        defaultGroupSequence.add( RentalCar.class );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( car != <span class="literal">null</span> &amp;&amp; !car.isRented() ) &#123;</span><br><span class="line">            defaultGroupSequence.add( CarChecks.class );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> defaultGroupSequence;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将这个Provider声明到相应类上，这样就会重写Default分组</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GroupSequenceProvider(RentalCarGroupSequenceProvider.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RentalCar</span> <span class="keyword">extends</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertFalse(message = &quot;The car is currently rented out&quot;, groups = RentalChecks.class)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> rented;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RentalCar</span><span class="params">(String manufacturer, String licencePlate, <span class="type">int</span> seatCount)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>( manufacturer, licencePlate, seatCount );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isRented</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> rented;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRented</span><span class="params">(<span class="type">boolean</span> rented)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.rented = rented;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Group-conversion"><a href="#Group-conversion" class="headerlink" title="Group conversion"></a>Group conversion</h3><p>如果校验某个分组和其它分组一起，出了可以使用@GroupSequence，也可以通过@ConvertGroup来实现，这个注解用于将某个分组转换成另外一个分组，说得有点抽象，看下面的例子。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Driver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(</span></span><br><span class="line"><span class="meta">            value = 18,</span></span><br><span class="line"><span class="meta">            message = &quot;You have to be 18 to drive a car&quot;,</span></span><br><span class="line"><span class="meta">            groups = DriverChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue(</span></span><br><span class="line"><span class="meta">            message = &quot;You first have to pass the driving test&quot;,</span></span><br><span class="line"><span class="meta">            groups = DriverChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> hasDrivingLicense;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Driver</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">passedDrivingTest</span><span class="params">(<span class="type">boolean</span> b)</span> &#123;</span><br><span class="line">        hasDrivingLicense = b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters and setters ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GroupSequence(&#123; CarChecks.class, Car.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="keyword">private</span> String manufacturer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size(min = 2, max = 14)</span></span><br><span class="line">    <span class="keyword">private</span> String licensePlate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Min(2)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> seatCount;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AssertTrue(</span></span><br><span class="line"><span class="meta">            message = &quot;The car has to pass the vehicle inspection first&quot;,</span></span><br><span class="line"><span class="meta">            groups = CarChecks.class</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> passedVehicleInspection;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Valid</span></span><br><span class="line">    <span class="meta">@ConvertGroup(from = Default.class, to = DriverChecks.class)</span></span><br><span class="line">    <span class="keyword">private</span> Driver driver;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Car</span><span class="params">(String manufacturer, String licencePlate, <span class="type">int</span> seatCount)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.manufacturer = manufacturer;</span><br><span class="line">        <span class="built_in">this</span>.licensePlate = licencePlate;</span><br><span class="line">        <span class="built_in">this</span>.seatCount = seatCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPassedVehicleInspection</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> passedVehicleInspection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassedVehicleInspection</span><span class="params">(<span class="type">boolean</span> passedVehicleInspection)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.passedVehicleInspection = passedVehicleInspection;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Driver <span class="title function_">getDriver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> driver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDriver</span><span class="params">(Driver driver)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.driver = driver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters and setters ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>校验代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a car and validate. The Driver is still null and does not get validated</span></span><br><span class="line"><span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>( <span class="string">&quot;VW&quot;</span>, <span class="string">&quot;USD-123&quot;</span>, <span class="number">4</span> );</span><br><span class="line">car.setPassedVehicleInspection( <span class="literal">true</span> );</span><br><span class="line">Set&lt;ConstraintViolation&lt;Car&gt;&gt; constraintViolations = validator.validate( car );</span><br><span class="line">assertEquals( <span class="number">0</span>, constraintViolations.size() );</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a driver who has not passed the driving test</span></span><br><span class="line"><span class="type">Driver</span> <span class="variable">john</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Driver</span>( <span class="string">&quot;John Doe&quot;</span> );</span><br><span class="line">john.setAge( <span class="number">18</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">// now let&#x27;s add a driver to the car</span></span><br><span class="line">car.setDriver( john );</span><br><span class="line">constraintViolations = validator.validate( car );</span><br><span class="line">assertEquals( <span class="number">1</span>, constraintViolations.size() );</span><br><span class="line">assertEquals(</span><br><span class="line">        <span class="string">&quot;The driver constraint should also be validated as part of the default group&quot;</span>,</span><br><span class="line">        constraintViolations.iterator().next().getMessage(),</span><br><span class="line">        <span class="string">&quot;You first have to pass the driving test&quot;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>从上面可以看到，校验程序只校验了默认分组，第一个和第二个校验的区别在于，Dirver是否有驾照。但是这里还是用的Default分组，由于使用@ConvertGroup将默认分组转换成DriverChecks分组，因此在校验的石油，DiverCheck就相当于默认分组，会被校验。</p>
<p>使用@ConvertGroup有以下三个要注意的点：</p>
<ol>
<li>@ConvertGroup要和@Valid一起使用</li>
<li>@ConvertGroup中的from值不能有相同的值</li>
<li>from值不能引用一个group sequence</li>
</ol>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>上面已经将Hibernate Validator基本的使用进行了整理。主要就是掌握如何在Bean和方法上声明约束，以及在使用约束需要注意级联验证和约束继承俩个点。另外就是对约束进行校验，主要通过Validator和ExecutableValidator俩个接口中的方法对应Bean和方法上的约束进行校验。</p>

    </div>

    
    
    
      

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>枫秀
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://fengxiu.club/archives/fc06a9d1.html" title="Hibernate Validator 学习与使用">http://fengxiu.club/archives/fc06a9d1.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/archives/a61a4fcc.html" rel="prev" title="Spring Validation教程">
      <i class="fa fa-chevron-left"></i> Spring Validation教程
    </a></div>
      <div class="post-nav-item">
    <a href="/archives/236c7534.html" rel="next" title="URL详解">
      URL详解 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-disqus">评论</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane disqus" id="comment-disqus">
              
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Hibernate-Validator-%E5%AD%A6%E4%B9%A0%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="nav-number">1.</span> <span class="nav-text">Hibernate Validator 学习与使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Hibernate-Validator%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">Hibernate Validator简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E4%BE%8B%E5%AD%90"><span class="nav-number">1.2.</span> <span class="nav-text">简单使用例子</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%A3%B0%E6%98%8E%E5%92%8C%E6%A0%A1%E9%AA%8C%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.</span> <span class="nav-text">如何声明和校验约束</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A3%B0%E6%98%8Ebean%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.1.</span> <span class="nav-text">声明bean约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E7%BA%A6%E6%9D%9F-field-constraints"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">属性约束(field constraints)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Property-level-constraints"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">Property-level constraints</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Container-element-%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">Container element 约束</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Class-level-%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.1.4.</span> <span class="nav-text">Class-level 约束</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%A1%E9%AA%8Cbean%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.2.</span> <span class="nav-text">校验bean约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96Validator%E5%AE%9E%E4%BE%8B"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">获取Validator实例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Validator-%E6%96%B9%E6%B3%95%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">Validator 方法介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#validate"><span class="nav-number">1.3.2.2.1.</span> <span class="nav-text">validate()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#validateProperty"><span class="nav-number">1.3.2.2.2.</span> <span class="nav-text">validateProperty()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#validateValue"><span class="nav-number">1.3.2.2.3.</span> <span class="nav-text">validateValue()</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E6%96%B9%E6%B3%95%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.3.</span> <span class="nav-text">声明方法约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">参数约束</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Cross-parameter%EF%BC%88%E4%BA%A4%E5%8F%89%E9%AA%8C%E8%AF%81%EF%BC%89"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">Cross-parameter（交叉验证）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.3.3.</span> <span class="nav-text">返回值约束</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E6%96%B9%E6%B3%95%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.4.</span> <span class="nav-text">验证方法约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%AE%9E%E4%BE%8B"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">获取实例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">方法使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E7%BD%AE%E7%9A%84Bean%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.3.5.</span> <span class="nav-text">内置的Bean约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%A6%E6%9D%9F%E7%BB%A7%E6%89%BF"><span class="nav-number">1.4.</span> <span class="nav-text">约束继承</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%A7%E8%81%94%E9%AA%8C%E8%AF%81"><span class="nav-number">1.5.</span> <span class="nav-text">级联验证</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E6%A0%A1%E9%AA%8C"><span class="nav-number">1.6.</span> <span class="nav-text">分组校验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Group-inheritance"><span class="nav-number">1.6.1.</span> <span class="nav-text">Group inheritance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%88%86%E7%BB%84%E9%AA%8C%E8%AF%81%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="nav-number">1.6.2.</span> <span class="nav-text">定义分组验证的顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%AE%9A%E4%B9%89Default-%E5%88%86%E7%BB%84"><span class="nav-number">1.6.3.</span> <span class="nav-text">重定义Default 分组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Group-conversion"><span class="nav-number">1.6.4.</span> <span class="nav-text">Group conversion</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">1.7.</span> <span class="nav-text">总结</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="枫秀"
      src="https://cdn.jsdelivr.net/gh/fengxiu/img/avatar.jpg">
  <p class="site-author-name" itemprop="name">枫秀</p>
  <div class="site-description" itemprop="description">记录学习日志</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">228</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">99</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">枫秀</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.5m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">22:41</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://fengxiu.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "http://fengxiu.club/archives/fc06a9d1.html";
    this.page.identifier = "archives/fc06a9d1.html";
    this.page.title = "Hibernate Validator 学习与使用";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://fengxiu.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/valine/1.3.10/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'ljY0VjHRpXGNJajqYEG9usUd-gzGzoHsz',
      appKey     : 'kK371eQflnC992Bf2YhhdBjM',
      placeholder: "",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
